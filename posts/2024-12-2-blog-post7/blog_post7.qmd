---
title: "Blog post7"
subtitle: ""
author: "group 3"
date: "2024-12-2"
description: "Thesis: The relationship between the popularity of different majors and employment outcomes"
image-alt: ""
categories: []
date-modified: "2024-12-9"
draft: false
---

```{r}
library(tidyverse)
library(dplyr)
library(ggplot2)
```

```{r}
education_cohort_combined_data1 <- read_rds("dataset/education_cohort_combined_data.rds")
education_cohort_combined_data1 <- education_cohort_combined_data1 |>
  mutate(
    EARN_MDN_5YR = as.numeric(EARN_MDN_5YR)
  )

field_summary <- education_cohort_combined_data1 |>
  group_by(CIPDESC) |>
  summarise(
    Avg_Earning_5YR = mean(EARN_MDN_5YR, na.rm = TRUE),
    Total_Earning_5YR = sum(EARN_MDN_5YR, na.rm = TRUE),
    Count = n()
  ) |>
  arrange(desc(Total_Earning_5YR))
```

```{r}
# Total earnings of different fields of study ranking
top_fields <- field_summary |>
  top_n(20, Total_Earning_5YR)
#Listing the fields of study with the highest employment outcomes in a descending order
ggplot(top_fields, aes(x = reorder(CIPDESC, -Total_Earning_5YR), y = Total_Earning_5YR)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  labs(title = "Top Fields of Study Total Earnings", x = "Field of Study", y = "Total Earnings)")
```

```{r}
# Average earnings of different fields of study ranking
top_fields2 <- field_summary |>
  top_n(20, Avg_Earning_5YR)
#Listing the fields of study with the highest employment outcomes in a descending order
ggplot(top_fields2, aes(x = reorder(CIPDESC, -Avg_Earning_5YR), y = Avg_Earning_5YR)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  labs(title = "Top Fields of Study Average Earnings", x = "Field of Study", y = "Average Earnings)")
```