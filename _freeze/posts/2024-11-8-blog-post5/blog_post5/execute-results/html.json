{
  "hash": "73848240d1186619563fd16ecffbd68e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Blog post5\"\nsubtitle: \"\"\nauthor: \"group 3\"\ndate: \"2024-11-8\"\ndescription: \"Data Combining\"\nimage-alt: \"\"\ncategories: []\ndate-modified: \"2024-11-11\"\ndraft: false\n---\n\n\nComments: All data loading and combine process are stored in the \"load_and_clean_new_dataset.R\" file in the same folder of blog post 5. \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n# Merge the new variables into the cleaned dataset\neducation_cohort_data_updated <- read_csv(here::here(\"dataset-ignore\", \"Most-Recent-Cohorts-Institution.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 6484 Columns: 3305\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2380): OPEID, OPEID6, INSTNM, CITY, STABBR, ZIP, ACCREDAGENCY, INSTURL,...\ndbl  (850): UNITID, SCH_DEG, HCM2, MAIN, NUMBRANCH, PREDDEG, HIGHDEG, CONTRO...\nlgl   (75): LOCALE2, UG, UGDS_WHITENH, UGDS_BLACKNH, UGDS_API, UGDS_AIANOLD,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nnew_variables <- education_cohort_data_updated |>\n  select(\n    INSTNM,\n    UGDS_ASIAN, \n    UGDS_BLACK, \n    UGDS_WHITE, \n    UGDS_HISP, \n    UGDS_AIAN, \n    UGDS_NHPI\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# load the current dataset\neducation_cohort_data_cleaned <- read_rds(here::here(\"dataset\", \"education_cohort_data_cleaned.rds\"))\neducation_cohort_data_full <- read_csv(here::here(\"dataset-ignore\", \"Most-Recent-Cohorts-Institution.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 6484 Columns: 3305\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2380): OPEID, OPEID6, INSTNM, CITY, STABBR, ZIP, ACCREDAGENCY, INSTURL,...\ndbl  (850): UNITID, SCH_DEG, HCM2, MAIN, NUMBRANCH, PREDDEG, HIGHDEG, CONTRO...\nlgl   (75): LOCALE2, UG, UGDS_WHITENH, UGDS_BLACKNH, UGDS_API, UGDS_AIANOLD,...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nnew_variables <- education_cohort_data_full |> \n  select(\n    INSTNM,       \n    UGDS_ASIAN,   #Asian students\n    UGDS_BLACK,   #Black students\n    UGDS_WHITE,   #White students\n    UGDS_HISP,    #Hispanic students\n    UGDS_AIAN,    #American Indian students\n    UGDS_NHPI     #Native Hawaiian students\n  )\n\neducation_cohort_data_cleaned <- education_cohort_data_cleaned |> \n  left_join(new_variables, by = \"INSTNM\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning in left_join(education_cohort_data_cleaned, new_variables, by = \"INSTNM\"): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 137 of `x` matches multiple rows in `y`.\nℹ Row 987 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n```\n\n\n:::\n\n```{.r .cell-code}\nwrite_rds(education_cohort_data_cleaned, file = here::here(\"dataset\", \"education_cohort_data_cleaned.rds\"))\n```\n:::\n\n\n# load the current dataset\neducation_cohort_data_institution <- read_rds(\"dataset/education_cohort_data_cleaned.rds\")\n\n# load the new dataset that will be combined\neducation_cohort_data_fields_of_study <- read_csv(here::here(\"dataset-ignore\", \"Most-Recent-Cohorts-Field-of-Study.csv\"))\n\n# filter the new dataset\neducation_cohort_data_fields_of_study_cleaned = education_cohort_data_fields_of_study |>\n  select(\n    'INSTNM',\n    'EARN_COUNT_WNE_5YR', # Number of graduates working and not enrolled 5 year after completing\n    'EARN_MDN_5YR', # Median earnings of graduates working and not enrolled 5 year after completing\n    'CIPDESC', # Text description of the field of study CIP Code\n    'CREDDESC', # Text description of the level of credential\n  )\n```\n# output the new cleaned dataset\nwrite_rds(education_cohort_data_fields_of_study_cleaned, file = here::here(\"dataset\", \"education_cohort_data_fields_of_study_cleaned.rds\")) \n\n# Combine: perform an inner join on 'INSTNM' to ensure only matching rows are kept\neducation_cohort_combined_data <- merge(education_cohort_data_fields_of_study_cleaned, \n                       education_cohort_data_institution, \n                       by = \"INSTNM\", \n                       all = FALSE)\n\n# Drop some columns\neducation_cohort_combined_data =  education_cohort_combined_data |>\n  select(-starts_with(\"C150\"),\n         -starts_with(\"UGDS_\"),\n         matches(\"SAT.*MID|ACT.*MID\"),\n         NPT41_PUB, NPT42_PUB, NPT43_PUB, NPT44_PUB, NPT45_PUB, \n         NPT41_PRIV, NPT42_PRIV, NPT43_PRIV, NPT44_PRIV, NPT45_PRIV\n         ) |>\n  filter(STABBR == \"MA\")\n\neducation_cohort_combined_data\n\n# output the combined dataset\nwrite_rds(education_cohort_combined_data, file = here::here(\"dataset\", \"education_cohort_combined_data.rds\")) \n\n```\n\n\n#```{r}\n#library(tidyverse)\n#library(dplyr)\n\n# Load the combined dataset\n#education_cohort_combined_data <- read_rds(\"dataset/education_cohort_combined_data.rds\")\n#education_cohort_combined_data\n```\n\nDescription of our new dataset: The dataset we chose to combine with our original dataset focuses on financial outcomes for various fields of study (CIPDESC) across institutions (INSTNM) with distinctions by student aid types and degree levels. This dataset can support analyses focused on education affordability, financial outcomes of higher education, and institutional comparisons in terms of student debt and post-graduation earnings. \n\nHow we combine them:  We started of by using \"Select\" clause to select the common variable name \"INSTNM\" in both datasets which is the name of the institutions. Then we selected some other variables that we thought are interesting. Some columns were also being dropped (every column starts with C150, we decided to use D150 instead) because we want the combined dataset to be less redundant. We also selected the columns for Midpoint of SAT and ACT scores and different net price tiers for public and private institutions, based on student income or other demographic criteria. Ultimately, we use \"filter\" to only include rows that STABBR == \"MA\" which means we only want the institutions located in Massachusetts.\n\nDifficulties while combining datasets: Although both datasets focus on the institutions in the US, the new dataset has too much observations (almost 23,0000 observations) since it includes every field of study in each institution. We are not sure if we need to clean the dataset to focus on only a few fields of study instead all of them. Moreover, we used \"start_with\" when we cleaned the first dataset so there are many redundant columns that we might not going to use in the future (ex: everything starts with \"SAT\" and everything starts with \"ACT\".) \n\nThe modified education_cohort_combined_data is then ready for further analysis, with a focus on SAT/ACT metrics and net price data for Massachusetts institutions only.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}